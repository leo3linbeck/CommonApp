/*	In order to make the helloWorld() function available client-side, you have to add a reference to the 'CommonApp' module in the GUI Designer.	The helloWorld() function can be executed from your JS file as follows:	alert(CommonApp.helloWorld());		For more information, refer to http://doc.wakanda.org/Wakanda0.Beta/help/Title/en/page1516.html*/var USPS_SEPARATOR = '+-+-+';var NEW_FAMILY_TEXT = 'SELECT TO ADD NEW FAMILY';exports.verifyAddress = function(data, debug) {	var xhr, getString, reqString, a, v, c, families;	if (debug) debugger;	try {		xhr = new XMLHttpRequest(); 		reqString = 'https://api.smartystreets.com/street-address?street=' + data.addr1 + (data.addr2 ? '&street2=' + data.addr2 : '') + '&city=' + data.city + '&state=TX&zipcode=' + data.zip + '&candidates=5&auth-id=fd972f01-719a-4d50-88e6-b0ce3f936098&auth-token=sEv4KscGrL2PJMD6WKCoxWpR%2BhsXCj6ht%2F9aU4VfpebYfRKwSO8rO%2BwkPohcjMyLpu6ujyDryvou5dqMZvSLzg%3D%3D';		getString = reqString.replace(/ /g,'+');		xhr.open('GET', getString, false); // to connect to a Web site synchronously		xhr.send(); // send the request	} catch (e) {		return ( { success: false, id: 'uspsNotFound', message: 'Address could not be verified.' } );	}	if (xhr.status === 200) {		v = JSON.parse(xhr.responseText)[0];		a = v.delivery_point_barcode;				families = ds.Family.query('uspsDeliveryPoint = :1', a);				c = families.find('name == :1', NEW_FAMILY_TEXT);		if (c === null) {			c = ds.Family.createEntity();			c.name = NEW_FAMILY_TEXT;			c.uspsDeliveryPoint = a;			families.add(c);		}		c.homeStreet1 = data.addr1;		c.homeStreet2 = data.addr2;		c.homeCity = data.city;		c.homeState = v.components.state_abbreviation;		c.homeZipCode = v.components.zipcode + '-' + v.components.plus4_code;		c.mapCoords = v.metadata.latitude + ',' + v.metadata.longitude;		c.save();				return ( { success: true, verified: v.length > 0, data: v, families: families } );	}	else {		return ( { success: false, id: 'webRequestFailure', message: 'Error in web request.' } );	}};